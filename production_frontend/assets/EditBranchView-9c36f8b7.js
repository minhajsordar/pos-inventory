import{af as N,u as U,g as B,f as q,ac as $,o as h,c as C,w as R,b as i,a as f,ax as A,e as y,ak as _,aj as v,Q as T}from"./index-b55a7827.js";import{Q as j}from"./QSelect-c33eb5ef.js";import{Q as z}from"./QPage-615bd1f9.js";import{u as L,a as b}from"./use-quasar-96558313.js";import{u as G,g as w}from"./userAuthStore-0c477450.js";import{e as Q,s as O}from"./validationHelper-21a8e46b.js";import"./QChip-1b4874fe.js";import"./QItemLabel-82cf5c84.js";import"./selection-af93f90a.js";import"./rtl-36dd996b.js";import"./format-6ceb96d6.js";const P=i("div",{class:"p-0 text-h5 mb-2"}," Add new branch ",-1),F={class:"mb-6"},I={key:0,class:"text-red-8 text-xs q-pl-sm"},M={class:"mb-6"},D={key:0,class:"text-red-8 text-xs q-pl-sm"},H={class:"mb-6"},J={key:0,class:"text-red-8 text-xs q-pl-sm"},ie={__name:"EditBranchView",setup(K){const a=L();G();const d=N(),V=U(),x=B([]),n=B({}),s=q({name:"",address:"",shop:""}),g=q({name:"",address:"",shop:""}),S=async()=>{var o;if(d.params.id=="create"){k();return}const l={method:"GET",url:"api/branch/branch_lists/"+d.params.id,headers:{Authorization:`Bearer ${w("token")}`}};try{a.loading.show();const e=await b.request(l);a.loading.hide(),s.name=e.data.name,g.name=e.data.name,s.address=e.data.address,g.address=e.data.address,s.shop=e.data.shop,g.shop=e.data.shop}catch(e){((o=e==null?void 0:e.response)==null?void 0:o.status)==401?a.notify({message:e.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):a.notify({message:e.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),a.loading.hide(),console.error(e)}finally{k()}};$(()=>{S()});const k=async()=>{var o;const l={method:"GET",url:"api/shop/shop_lists",headers:{Authorization:`Bearer ${w("token")}`}};try{a.loading.show();const e=await b.request(l);x.value=e.data.shops.map(t=>(t.label=t.name,t.value=t._id,s.shop===t._id&&(s.shop=t),t)),a.loading.hide()}catch(e){((o=e==null?void 0:e.response)==null?void 0:o.status)==401?a.notify({message:e.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):a.notify({message:e.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),a.loading.hide(),console.error(e)}},E=async l=>{var t,c,p,u,m;l.preventDefault(),n.value={};const o={};if(s.name&&(o.name=s.name),Q(s.name)||(n.value.name="Required feild"),s.address&&(o.address=s.address),Q(s.address)||(n.value.address="Required feild"),(t=s==null?void 0:s.shop)!=null&&t._id&&(o.shop=s.shop._id),O((c=s==null?void 0:s.shop)==null?void 0:c._id)||(n.value.shop="Required feild"),Object.keys(n.value).length!==0)return;if(Object.keys(o).length<=0){a.notify({message:"Empty Form Submission Not Allowed",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]});return}const e={headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${w("token")}`},data:o};d.params.id=="create"?(e.method="post",e.url="api/branch/branch_lists"):(e.method="put",e.url="api/branch/branch_lists/"+d.params.id);try{const r=await b.request(e);(p=d.query)!=null&&p.redirect?V.push(`/${(u=d.query)==null?void 0:u.redirect}`):V.push("/dashboard/branch/branch_list"),a.notify({message:"Updated Successfully!",color:"primary",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]})}catch(r){((m=r==null?void 0:r.response)==null?void 0:m.status)==401?a.notify({message:r.response.data.message+". Login to try again.",color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}):a.notify({message:r.message,color:"red",position:"top",actions:[{icon:"close",color:"white",handler:()=>{}}]}),console.error(r)}};return(l,o)=>(h(),C(z,{padding:""},{default:R(()=>{var e,t,c,p,u,m;return[P,i("div",null,[i("div",F,[f(A,{label:"Name *",type:"text",placeholder:"Name",modelValue:s.name,"onUpdate:modelValue":o[0]||(o[0]=r=>s.name=r),outlined:"",dense:""},null,8,["modelValue"]),(e=n.value)!=null&&e.name?(h(),y("div",I,[i("span",null,_((t=n.value)==null?void 0:t.name),1)])):v("",!0)]),i("div",M,[f(A,{label:"Address *",type:"text",placeholder:"Address",modelValue:s.address,"onUpdate:modelValue":o[1]||(o[1]=r=>s.address=r),outlined:"",dense:""},null,8,["modelValue"]),(c=n.value)!=null&&c.address?(h(),y("div",D,[i("span",null,_((p=n.value)==null?void 0:p.address),1)])):v("",!0)]),i("div",H,[f(j,{label:"Select an option for Shop *",placeholder:"Value",modelValue:s.shop,"onUpdate:modelValue":o[2]||(o[2]=r=>s.shop=r),options:x.value,outlined:"",dense:""},null,8,["modelValue","options"]),(u=n.value)!=null&&u.shop?(h(),y("div",J,[i("span",null,_((m=n.value)==null?void 0:m.shop),1)])):v("",!0)]),f(T,{label:l.$route.params.id==="create"?"Create Branch":"Update Branch",color:"green",onClick:E},null,8,["label"])])]}),_:1}))}};export{ie as default};
