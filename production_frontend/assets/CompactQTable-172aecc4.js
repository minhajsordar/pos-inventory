import{k as M,y as z,l as H,m as P,p as q,af as I,u as K,g as b,f as W,ac as X,o as g,e as _,a,w as d,b as p,aX as O,Q as r,ai as G,c as U,aj as h,ak as Y,h as Z,au as Q,ax as V,j as ee,aw as le}from"./index-1afe7156.js";import{Q as te,C as oe}from"./QSpace-f97a4fcb.js";import{Q as F}from"./QSelect-38e1999a.js";import{Q as ne}from"./QTable-78fe1a21.js";import{u as ae}from"./use-quasar-7dcfde9a.js";const se=M({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(u,{slots:m}){const o=z(),v=H(()=>"q-td"+(u.autoWidth===!0?" q-table--col-auto-width":"")+(u.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(u.props===void 0)return P("td",{class:v.value},q(m.default));const y=o.vnode.key,c=(u.props.colsMap!==void 0?u.props.colsMap[y]:null)||u.props.col;if(c===void 0)return;const{row:f}=u.props;return P("td",{class:v.value+c.__tdClass(f),style:c.__tdStyle(f)},q(m.default))}}});function A(u){setTimeout(()=>{window.URL.revokeObjectURL(u.href)},1e4),u.remove()}function ue(u,m,o={}){const{mimeType:v,byteOrderMark:y,encoding:c}=typeof o=="string"?{mimeType:o}:o,f=c!==void 0?new TextEncoder(c).encode([m]):m,B=y!==void 0?[y,f]:[f],n=new Blob(B,{type:v||"application/octet-stream"}),i=document.createElement("a");i.href=window.URL.createObjectURL(n),i.setAttribute("download",u),typeof i.download>"u"&&i.setAttribute("target","_blank"),i.classList.add("hidden"),i.style.position="fixed",document.body.appendChild(i);try{return i.click(),A(i),!0}catch(k){return A(i),k}}const ie={class:"flex justify-center items-center"},de={key:0},re={class:"inline-flex q-gutter-sm"},pe={key:1},me=p("span",null,"Keyword Filter",-1),ce=p("span",null,"Search by keyword",-1),fe=p("span",null,"Date Range Filter From",-1),ve=p("span",null,"To",-1),ge=p("span",null,"Value Range Filter Field",-1),ye=p("span",null,"From ",-1),be=p("span",null,"To ",-1),Ue={__name:"CompactQTable",props:{dataList:Array,columns:Array,page:Number,pages:Number,showEdit:Boolean,showDelete:Boolean},emits:["updatePaginate","onFilter","onEdit","onDelete"],setup(u,{emit:m}){const o=u,v=I(),y=K(),c=b([]),f=b(!1),B=b(null),n=W({keywords:null,gt:null,lt:null,gtValue:null,ltValue:null,filterColumn:null,rangeColumn:null}),i=()=>{const t=JSON.parse(JSON.stringify(n));t!=null&&t.gtValue&&(t.gtValue=Number(t.gtValue)-1),t!=null&&t.ltValue&&(t.ltValue=Number(t.ltValue)+1),m("onFilter",t),L(t)},k=()=>{n.filterColumn=null,n.rangeColumn=null,n.keywords=null,n.gt=null,n.lt=null,n.gtValue=null,n.ltValue=null},E=()=>{k(),i()},T=b([]),R=ae(),w=b([]);X(()=>{w.value=o.columns.map(t=>t.name),c.value=o.columns.filter(t=>t.name!=="action"),n.filterColumn=o.columns.map(t=>t.name)[0],n.rangeColumn=o.columns.map(t=>t.name)[0]});const S=b({sortBy:"createdAt",descending:!0,page:o.page||1,rowsPerPage:10}),j=t=>{t.sortBy||(t.sortBy="createdAt"),m("updatePaginate",t),L(t)},C=t=>{const l=JSON.parse(JSON.stringify(S.value));l!=null&&l.sortBy||(l.sortBy="createdAt"),l.page=t,j(l)},L=t=>{const l=new URLSearchParams(v.query),e={};for(const[x,J]of l)e[`${x}`]=J;const s=Object.keys(t);for(const x of s)e[`${x}`]=t[`${x}`];const $=new URLSearchParams(e);y.push(v.path+"?"+$.toString())};function N(t,l,e){let s=l!==void 0?l(t,e):t;return s=s==null?"":String(s),s=s.split('"').join('""'),`"${s}"`}function D(){const t=[o.columns.map(e=>N(e.label))].concat(o.dataList.map(e=>o.columns.map(s=>N(typeof s.field=="function"?s.field(e):e[s.field===void 0?s.name:s.field],s.format,e)).join(","))).join(`\r
`);ue("table-export.csv",t,"text/csv")!==!0&&R.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}return(t,l)=>(g(),_("div",null,[a(ne,{class:"bg-grey-2",ref_key:"tableRef",ref:B,flat:"",bordered:"",title:"Treats",rows:o.dataList,columns:o.columns,"row-key":"name",separator:"cell",selection:"multiple",selected:T.value,"onUpdate:selected":l[6]||(l[6]=e=>T.value=e),"visible-columns":w.value,pagination:S.value,"onUpdate:pagination":[l[7]||(l[7]=e=>S.value=e),l[8]||(l[8]=e=>j(e))],"rows-per-page-options":[5,10,15,20,25,30,50]},{"header-selection":d(e=>[p("div",ie,[a(O,{modelValue:e.selected,"onUpdate:modelValue":s=>e.selected=s},null,8,["modelValue","onUpdate:modelValue"])])]),"body-selection":d(e=>[a(O,{modelValue:e.selected,"onUpdate:modelValue":s=>e.selected=s},null,8,["modelValue","onUpdate:modelValue"])]),top:d(()=>[a(r,{onClick:l[0]||(l[0]=e=>f.value=!0),flat:"",icon:"filter_alt",label:"Filter",dense:"",title:"open filter popup"}),a(r,{class:"q-mr-sm",icon:"clear",color:"red",onClick:E,dense:"",title:"clear filter"}),a(te),a(F,{modelValue:w.value,"onUpdate:modelValue":l[1]||(l[1]=e=>w.value=e),multiple:"",outlined:"",dense:"","options-dense":"","display-value":G(R).lang.table.columns,"emit-value":"","map-options":"",options:o.columns,"option-value":"name",title:"hide unhide columns","options-cover":"",style:{"max-width":"105px"}},null,8,["modelValue","display-value","options"]),a(r,{class:"q-px-sm q-ml-sm",color:"cyan-8","icon-right":"archive","no-caps":"",onClick:D,title:"Export as csv"})]),"body-cell":d(e=>[a(se,{props:e},{default:d(()=>[e.col.name==="action"?(g(),_("div",de,[p("div",re,[o.showEdit?(g(),U(r,{key:0,label:"Edit",size:"sm",color:"green-9",onClick:s=>{m("onEdit",e.row)}},null,8,["onClick"])):h("",!0),o.showDelete?(g(),U(r,{key:1,label:"Delete",size:"sm",color:"red-9",onClick:s=>{m("onDelete",e.row)}},null,8,["onClick"])):h("",!0)])])):(g(),_("div",pe,Y(e.value),1))]),_:2},1032,["props"])]),pagination:d(e=>[o.page!==1?(g(),U(r,{key:0,icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:o.page===1,onClick:l[2]||(l[2]=()=>C(1))},null,8,["disable"])):h("",!0),a(r,{icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:o.page===1,onClick:l[3]||(l[3]=()=>C(o.page-1))},null,8,["disable"]),a(r,{icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:o.page==o.pages,onClick:l[4]||(l[4]=()=>C(o.page+1))},null,8,["disable"]),o.page<o.pages?(g(),U(r,{key:1,icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:o.page==o.pages,onClick:l[5]||(l[5]=()=>C(o.pages))},null,8,["disable"])):h("",!0)]),_:1},8,["rows","columns","selected","visible-columns","pagination"]),a(le,{modelValue:f.value,"onUpdate:modelValue":l[16]||(l[16]=e=>f.value=e),persistent:""},{default:d(()=>[a(Z,{style:{width:"400px","max-width":"80vw"}},{default:d(()=>[a(Q,null,{default:d(()=>[me,a(F,{modelValue:n.filterColumn,"onUpdate:modelValue":l[9]||(l[9]=e=>n.filterColumn=e),outlined:"",dense:"","options-dense":"","emit-value":"","map-options":"",options:c.value,"option-value":"name",title:"filter key","options-cover":""},null,8,["modelValue","options"]),ce,a(V,{"model-value":n.keywords,"onUpdate:modelValue":l[10]||(l[10]=e=>n.keywords=e),outlined:"",dense:"",type:"text",placeholder:"keyword filter...",debounce:"1000"},null,8,["model-value"])]),_:1}),a(Q,{class:"q-pt-none"},{default:d(()=>[p("div",null,[fe,a(V,{"model-value":n.gt,"onUpdate:modelValue":l[11]||(l[11]=e=>n.gt=e),outlined:"",dense:"",type:"date",debounce:"1000"},null,8,["model-value"]),ve,a(V,{"model-value":n.lt,"onUpdate:modelValue":l[12]||(l[12]=e=>n.lt=e),outlined:"",dense:"",type:"date",debounce:"1000"},null,8,["model-value"])])]),_:1}),a(Q,{class:"q-pt-none"},{default:d(()=>[ge,p("div",null,[a(F,{modelValue:n.rangeColumn,"onUpdate:modelValue":l[13]||(l[13]=e=>n.rangeColumn=e),outlined:"",dense:"","options-dense":"","emit-value":"","map-options":"",options:c.value,"option-value":"name",title:"range filter key","options-cover":""},null,8,["modelValue","options"]),ye,a(V,{"model-value":n.gtValue,"onUpdate:modelValue":l[14]||(l[14]=e=>n.gtValue=e),outlined:"",dense:"",type:"number",debounce:"1000"},null,8,["model-value"]),be,a(V,{"model-value":n.ltValue,"onUpdate:modelValue":l[15]||(l[15]=e=>n.ltValue=e),outlined:"",dense:"",type:"number",debounce:"1000"},null,8,["model-value"])])]),_:1}),a(Q,{class:"q-pt-none flex justify-end"},{default:d(()=>[ee(a(r,{label:"Done",color:"primary",onClick:i},null,512),[[oe]]),a(r,{class:"q-ml-sm",label:"Clear",color:"red",onClick:k})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{Ue as _};
